{% comment %}
  Renders a collection card - Tailwind version

  Accepts:
  - card_collection: {Object} Collection Liquid object
  - media_aspect_ratio: {String} Size of the card. Values are "square", "portrait", "adapt". Default is "square"
  - columns: {Number} Number of columns in grid
  - placeholder_image: {String} Placeholder image when collection is empty

  Usage:
  {% render 'card-collection', card_collection: collection %}
{% endcomment %}

{%- liquid
  assign aspect_class = 'aspect-square'
  if media_aspect_ratio == 'portrait'
    assign aspect_class = 'aspect-[3/4]'
  elsif media_aspect_ratio == 'adapt' and card_collection.featured_image
    assign aspect_class = ''
  endif
-%}

<article class="group relative">
  <a
    href="{{ card_collection.url | default: '#' }}"
    class="block"
    {% if card_collection == blank %}aria-disabled="true"{% endif %}
  >
    {%- comment -%} Image Container {%- endcomment -%}
    <div class="relative overflow-hidden rounded-lg bg-neutral-100 {{ aspect_class }}">
      {%- if card_collection.featured_image -%}
        <img
          srcset="
            {%- if card_collection.featured_image.width >= 165 -%}{{ card_collection.featured_image | image_url: width: 165 }} 165w,{%- endif -%}
            {%- if card_collection.featured_image.width >= 330 -%}{{ card_collection.featured_image | image_url: width: 330 }} 330w,{%- endif -%}
            {%- if card_collection.featured_image.width >= 535 -%}{{ card_collection.featured_image | image_url: width: 535 }} 535w,{%- endif -%}
            {%- if card_collection.featured_image.width >= 750 -%}{{ card_collection.featured_image | image_url: width: 750 }} 750w,{%- endif -%}
            {%- if card_collection.featured_image.width >= 1000 -%}{{ card_collection.featured_image | image_url: width: 1000 }} 1000w,{%- endif -%}
            {{ card_collection.featured_image | image_url }} {{ card_collection.featured_image.width }}w
          "
          src="{{ card_collection.featured_image | image_url: width: 750 }}"
          sizes="
            (min-width: {{ settings.page_width }}px) {{ settings.page_width | minus: 100 | divided_by: columns | default: 3 }}px,
            (min-width: 750px) {% if columns > 1 %}calc((100vw - 10rem) / {{ columns | default: 3 }}){% else %}calc(100vw - 10rem){% endif %},
            calc(100vw - 3rem)
          "
          alt="{{ card_collection.featured_image.alt | escape }}"
          height="{{ card_collection.featured_image.height }}"
          width="{{ card_collection.featured_image.width }}"
          loading="lazy"
          class="absolute inset-0 w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"
          {% if media_aspect_ratio == 'adapt' %}
            style="aspect-ratio: {{ card_collection.featured_image.aspect_ratio }};"
          {% endif %}
        >

        {%- comment -%} Overlay {%- endcomment -%}
        <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-black/20 to-transparent"></div>

        {%- comment -%} Content Overlay {%- endcomment -%}
        <div class="absolute inset-0 flex flex-col justify-end p-4 md:p-6">
          <h3 class="text-lg md:text-xl font-semibold text-white leading-tight">
            {{ card_collection.title | escape }}
          </h3>
          {%- if card_collection.description != blank -%}
            <p class="mt-1 text-sm text-white/80 line-clamp-2">
              {{ card_collection.description | strip_html | truncatewords: 12 }}
            </p>
          {%- endif -%}
          <div class="flex items-center gap-1 mt-2 text-sm text-white/80">
            <span>{{ card_collection.products_count }} {{ card_collection.products_count | pluralize: 'product', 'products' }}</span>
            <span class="inline-flex transform transition-transform duration-300 group-hover:translate-x-1">
              {%- render 'icon', name: 'arrow-right', size: '14' -%}
            </span>
          </div>
        </div>

      {%- elsif card_collection != blank -%}
        {%- comment -%} No Image - Text Only Card {%- endcomment -%}
        <div class="absolute inset-0 flex flex-col justify-center items-center p-4 md:p-6 bg-neutral-100">
          <h3 class="text-lg md:text-xl font-semibold text-neutral-900 text-center leading-tight">
            {{ card_collection.title | escape }}
          </h3>
          {%- if card_collection.description != blank -%}
            <p class="mt-2 text-sm text-neutral-600 text-center line-clamp-2">
              {{ card_collection.description | strip_html | truncatewords: 12 }}
            </p>
          {%- endif -%}
          <div class="flex items-center gap-1 mt-3 text-sm font-medium text-neutral-900">
            <span>Shop now</span>
            <span class="inline-flex transform transition-transform duration-300 group-hover:translate-x-1">
              {%- render 'icon', name: 'arrow-right', size: '14' -%}
            </span>
          </div>
        </div>

      {%- else -%}
        {%- comment -%} Placeholder {%- endcomment -%}
        <div class="absolute inset-0 flex flex-col justify-center items-center p-4 md:p-6 bg-neutral-100">
          <div class="w-16 h-16 mb-4 text-neutral-300">
            {{ placeholder_image | default: 'collection-1' | placeholder_svg_tag: 'w-full h-full' }}
          </div>
          <h3 class="text-lg font-semibold text-neutral-400 text-center">
            {{ 'onboarding.collection_title' | t }}
          </h3>
        </div>
      {%- endif -%}
    </div>
  </a>
</article>
