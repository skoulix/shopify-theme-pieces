{%- comment -%}
  Image Snippet - Skeleton + Tailwind

  @param {image} image - The image to render
  @param {string} [url] - Optional link URL
  @param {string} [link_label] - Accessible label for the link (for image-only links)
  @param {string} [class] - Additional CSS classes
  @param {number} [width] - Max width for srcset
  @param {number} [height] - Max height (for aspect ratio)
  @param {string} [crop] - Crop position
  @param {string} [loading] - Loading strategy (lazy/eager)
  @param {string} [alt] - Alt text override

  @example
  {% render 'image', image: product.featured_image %}
  {% render 'image', image: product.featured_image, url: product.url, link_label: product.title, class: 'rounded-lg' %}
{%- endcomment -%}

{%- liquid
  assign width = width | default: image.width | default: 800
  assign loading = loading | default: 'lazy'
  assign alt = alt | default: image.alt | default: ''
  assign sizes = sizes | default: '(max-width: 768px) 100vw, 50vw'
  assign widths = widths | default: '400, 600, 800, 1200'
  assign link_label = link_label | default: alt

  comment
    Focal point support - gets the focal point from image presentation settings
    Format is "X% Y%" which maps directly to CSS object-position
  endcomment
  assign focal_point = image.presentation.focal_point | default: '50% 50%'
  assign focal_point_style = 'object-position: ' | append: focal_point
-%}

{%- if url -%}
  <a href="{{ url }}" class="block {{ class }}"{% if link_label != blank %} aria-label="{{ link_label }}"{% endif %}>
    {{ image | image_url: width: width, height: height, crop: crop | image_tag:
      class: 'w-full h-auto object-cover',
      style: focal_point_style,
      loading: loading,
      sizes: sizes,
      widths: widths,
      alt: alt
    }}
  </a>
{%- else -%}
  <div class="{{ class }}">
    {{ image | image_url: width: width, height: height, crop: crop | image_tag:
      class: 'w-full h-auto object-cover',
      style: focal_point_style,
      loading: loading,
      sizes: sizes,
      widths: widths,
      alt: alt
    }}
  </div>
{%- endif -%}
