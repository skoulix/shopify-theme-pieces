{%- comment -%}
  CSS Variables - Theme settings to CSS custom properties
  Generates all CSS variables from theme settings for styling
{%- endcomment -%}

{%- comment -%}
  Font Loading - Uses 'fallback' for better perceived performance
  'fallback' shows system font for ~100ms, then swaps (reduces layout shift vs 'swap')
{%- endcomment -%}
{% style %}
  {{ settings.type_body_font | font_face: font_display: 'fallback' }}
  {{ settings.type_body_font | font_modify: 'weight', 'bold' | font_face: font_display: 'fallback' }}
  {{ settings.type_header_font | font_face: font_display: 'fallback' }}
{% endstyle %}

{%- comment -%} Preload primary fonts - manual link tags required for CDN font URLs {%- endcomment -%}
{%- liquid
  assign body_font_url = settings.type_body_font | font_url
  assign header_font_url = settings.type_header_font | font_url
-%}
{%- if body_font_url != blank and settings.type_body_font.system? == false -%}
  <link rel="preload" href="{{ body_font_url }}" as="font" type="font/woff2" crossorigin>
{%- endif -%}
{%- if header_font_url != blank and settings.type_header_font.system? == false -%}
  <link rel="preload" href="{{ header_font_url }}" as="font" type="font/woff2" crossorigin>
{%- endif -%}

{%- comment -%} Shadow presets {%- endcomment -%}
{%- liquid
  case settings.button_shadow
    when 'sm'
      assign button_shadow_value = '0 1px 2px 0 rgb(0 0 0 / 0.05)'
      assign button_shadow_hover_value = '0 1px 2px 0 rgb(0 0 0 / 0.05)'
    when 'md'
      assign button_shadow_value = '0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1)'
      assign button_shadow_hover_value = '0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1)'
    when 'hard'
      assign button_shadow_value = '4px 4px 0 0 var(--color-text)'
      assign button_shadow_hover_value = '4px 4px 0 0 var(--color-primary)'
    else
      assign button_shadow_value = 'none'
      assign button_shadow_hover_value = 'none'
  endcase

  case settings.card_shadow
    when 'sm'
      assign card_shadow_value = '0 1px 2px 0 rgb(0 0 0 / 0.05)'
    when 'md'
      assign card_shadow_value = '0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1)'
    when 'lg'
      assign card_shadow_value = '0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1)'
    when 'hard'
      assign card_shadow_value = '4px 4px 0 0 ' | append: settings.color_text
    else
      assign card_shadow_value = 'none'
  endcase

  case settings.input_shadow
    when 'sm'
      assign input_shadow_value = '0 1px 2px 0 rgb(0 0 0 / 0.05)'
      assign input_shadow_focus_value = '0 1px 2px 0 rgb(0 0 0 / 0.05), 0 0 0 2px color-mix(in srgb, var(--color-primary) 20%, transparent)'
    when 'md'
      assign input_shadow_value = '0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1)'
      assign input_shadow_focus_value = '0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1), 0 0 0 2px color-mix(in srgb, var(--color-primary) 20%, transparent)'
    when 'hard'
      assign input_shadow_value = '4px 4px 0 0 var(--color-text)'
      assign input_shadow_focus_value = '4px 4px 0 0 var(--color-primary)'
    else
      assign input_shadow_value = 'none'
      assign input_shadow_focus_value = '0 0 0 2px color-mix(in srgb, var(--color-primary) 20%, transparent)'
  endcase

  assign body_font_scale = settings.body_scale | divided_by: 100.0
  assign heading_font_scale = settings.heading_scale | divided_by: 100.0
  assign heading_letter_spacing = settings.heading_letter_spacing | divided_by: 1000.0
  assign body_letter_spacing = settings.body_letter_spacing | divided_by: 1000.0
-%}

<style>
  /* ==========================================================================
     Color Scheme CSS Variables
     Generates classes for each color scheme that sections can use
     ========================================================================== */

  {% for scheme in settings.color_schemes -%}
    {% if forloop.index == 1 -%}
      :root,
    {%- endif %}
    .color-{{ scheme.id }} {
      --color-background: {{ scheme.settings.background }};
      --color-background-gradient: {% if scheme.settings.background_gradient != blank %}{{ scheme.settings.background_gradient }}{% else %}{{ scheme.settings.background }}{% endif %};
      --color-background-secondary: color-mix(in srgb, {{ scheme.settings.text }} 5%, {{ scheme.settings.background }});
      --color-text: {{ scheme.settings.text }};
      --color-text-secondary: {{ scheme.settings.text_secondary }};
      --color-primary: {{ scheme.settings.primary }};
      --color-primary-contrast: {{ scheme.settings.primary_contrast }};
      --color-border: {{ scheme.settings.border }};
    }
  {% endfor %}

  :root {
    /* Typography */
    --font-body: {{ settings.type_body_font.family }}, {{ settings.type_body_font.fallback_families }};
    --font-body-weight: {{ settings.type_body_font.weight }};
    --font-body-style: {{ settings.type_body_font.style }};
    --font-heading: {{ settings.type_header_font.family }}, {{ settings.type_header_font.fallback_families }};
    --font-heading-weight: {{ settings.type_header_font.weight }};
    --font-heading-style: {{ settings.type_header_font.style }};
    --body-font-scale: {{ body_font_scale }};
    --heading-font-scale: {{ heading_font_scale }};
    --heading-letter-spacing: {{ heading_letter_spacing }}em;
    --body-letter-spacing: {{ body_letter_spacing }}em;

    /* Global UI colors (not part of schemes) */
    --color-sale: {{ settings.color_sale }};

    /* Status Colors */
    --color-success: #22c55e;
    --color-error: #ef4444;
    --color-warning: #f59e0b;
    --color-info: #3b82f6;

    /* Layout */
    --page-max-width: {{ settings.page_width }}px;
    --page-padding: 24px;
    --page-vertical-padding: {{ settings.page_vertical_padding | times: 0.4 }}px;
    --section-vertical-padding: {{ settings.section_vertical_padding | default: 80 | times: 0.5 }}px;
    --header-height: 65px;

    /* Buttons */
    --button-radius: {{ settings.button_radius }}px;
    --button-border-width: {{ settings.button_border_width }}px;
    --button-shadow: {{ button_shadow_value }};
    --button-shadow-hover: {{ button_shadow_hover_value }};

    /* Cards */
    --card-radius: {{ settings.card_radius }}px;
    --card-border-width: {{ settings.card_border_width }}px;
    --card-shadow: {{ card_shadow_value }};

    /* Inputs */
    --input-radius: {{ settings.input_radius }}px;
    --input-border-width: {{ settings.input_border_width }}px;
    --input-shadow: {{ input_shadow_value }};
    --input-shadow-focus: {{ input_shadow_focus_value }};

    /* Logo */
    --logo-width: {{ settings.logo_width_mobile | default: 80 }}px;

    /* Animation Durations - Shared timing values */
    --duration-instant: 0ms;
    --duration-fast: 150ms;
    --duration-normal: 300ms;
    --duration-slow: 500ms;
    --duration-slower: 800ms;

    /* Z-Index Layers */
    --z-dropdown: 50;
    --z-sticky: 60;
    --z-drawer: 100;
    --z-modal: 9999;
    --z-toast: 10000;
  }

  /* Color scheme sections apply background gradient and text colors */
  {% for scheme in settings.color_schemes -%}
    .color-{{ scheme.id }}{% unless forloop.last %},{% endunless %}
  {% endfor %} {
    background: var(--color-background-gradient);
    color: var(--color-text);
  }

  @media (min-width: 1024px) {
    :root {
      --logo-width: {{ settings.logo_width }}px;
    }
  }

  /* Apply base styles */
  html {
    font-size: calc(1rem * var(--body-font-scale));
    /* Prevent layout shift when scrollbar appears/disappears during page transitions */
    scrollbar-gutter: stable;
  }

  body {
    font-family: var(--font-body);
    font-weight: var(--font-body-weight);
    font-style: var(--font-body-style);
    background-color: var(--color-background);
    color: var(--color-text);
  }

  h1, h2, h3, h4, h5, h6,
  .heading,
  .font-heading,
  .page-header-subtitle,
  .section-label {
    font-family: var(--font-heading);
    font-weight: var(--font-heading-weight);
    font-style: var(--font-heading-style);
    {% if settings.headings_uppercase %}text-transform: uppercase;{% endif %}
  }

  /* Heading scale */
  h1 { font-size: calc(2.25rem * var(--heading-font-scale)); }
  h2 { font-size: calc(1.875rem * var(--heading-font-scale)); }
  h3 { font-size: calc(1.5rem * var(--heading-font-scale)); }
  h4 { font-size: calc(1.25rem * var(--heading-font-scale)); }
  h5 { font-size: calc(1.125rem * var(--heading-font-scale)); }
  h6 { font-size: calc(1rem * var(--heading-font-scale)); }

  /* Links */
  a {
    color: inherit;
  }

  a:hover {
    color: var(--color-primary);
  }

  /* Button uppercase setting - applied to all button variants */
  .btn,
  button[type="submit"] {
    {% if settings.buttons_uppercase %}text-transform: uppercase;{% endif %}
  }

  /* Section links */
  .text-hover-reveal,
  .section-link,
  .link-cta {
    {% if settings.buttons_uppercase %}text-transform: uppercase;{% endif %}
  }

  /* Cards */
  .card {
    background-color: var(--color-background);
    border: var(--card-border-width) solid var(--color-border);
    border-radius: var(--card-radius);
    box-shadow: var(--card-shadow);
  }

  /* Inputs */
  input:not([type="checkbox"]):not([type="radio"]),
  textarea,
  select {
    background-color: var(--color-background);
    border: var(--input-border-width) solid var(--color-border);
    border-radius: var(--input-radius);
    box-shadow: var(--input-shadow);
    color: var(--color-text);
  }

  input:not([type="checkbox"]):not([type="radio"]):focus,
  textarea:focus,
  select:focus {
    border-color: var(--color-primary);
    outline: none;
    box-shadow: var(--input-shadow-focus);
  }

  /* Sale prices */
  .sale-price,
  .price--on-sale {
    color: var(--color-sale);
  }

  /* Secondary text */
  .text-secondary {
    color: var(--color-text-secondary);
  }

  /* Background utilities */
  .bg-secondary {
    background-color: var(--color-background-secondary);
  }

  /* Border utilities */
  .border-theme {
    border-color: var(--color-border);
  }

  /* Responsive page and section vertical padding */
  @media (min-width: 768px) {
    :root {
      --page-vertical-padding: {{ settings.page_vertical_padding | times: 0.6 }}px;
      --section-vertical-padding: {{ settings.section_vertical_padding | default: 80 | times: 0.7 }}px;
    }
  }

  @media (min-width: 1024px) {
    :root {
      --page-vertical-padding: {{ settings.page_vertical_padding | times: 0.8 }}px;
      --section-vertical-padding: {{ settings.section_vertical_padding | default: 80 | times: 0.85 }}px;
    }
  }

  @media (min-width: 1280px) {
    :root {
      --page-vertical-padding: {{ settings.page_vertical_padding }}px;
      --section-vertical-padding: {{ settings.section_vertical_padding | default: 80 }}px;
    }
  }

  /* Layout utilities - respect theme settings */
  .page-container {
    max-width: var(--page-max-width);
    margin-left: auto;
    margin-right: auto;
    padding-left: var(--page-padding);
    padding-right: var(--page-padding);
  }

  .page-full {
    padding-left: var(--page-padding);
    padding-right: var(--page-padding);
  }

  /* Policy pages styling - use !important to override Shopify's default 65ch max-width */
  .shopify-policy__container {
    max-width: var(--page-max-width) !important;
    margin-left: auto;
    margin-right: auto;
    padding-left: var(--page-padding);
    padding-right: var(--page-padding);
    padding-top: var(--page-vertical-padding);
    padding-bottom: var(--page-vertical-padding);
  }

  .shopify-policy__body {
    max-width: none !important;
    color: var(--color-text);
  }

  .shopify-policy__title {
    font-family: var(--font-heading-family);
    font-size: calc(clamp(2.5rem, 10vw, 4.5rem) * var(--heading-font-scale, 1));
    font-weight: 700;
    letter-spacing: -0.03em;
    line-height: 0.9;
    color: var(--color-text);
    margin-bottom: 2rem;
  }

  @media (min-width: 1024px) {
    .shopify-policy__title {
      font-size: calc(clamp(3.5rem, 7vw, 6rem) * var(--heading-font-scale, 1));
    }
  }

  .shopify-policy__body {
    max-width: 48rem;
    color: var(--color-text);
  }

  .shopify-policy__body h1,
  .shopify-policy__body h2,
  .shopify-policy__body h3,
  .shopify-policy__body h4,
  .shopify-policy__body h5,
  .shopify-policy__body h6 {
    font-family: var(--font-heading-family);
    font-weight: 600;
    color: var(--color-text);
    margin-top: 2em;
    margin-bottom: 0.5em;
  }

  .shopify-policy__body p {
    margin-bottom: 1em;
    line-height: 1.7;
  }

  .shopify-policy__body a {
    color: var(--color-primary);
    text-decoration: underline;
  }

  .shopify-policy__body ul,
  .shopify-policy__body ol {
    margin-bottom: 1em;
    padding-left: 1.5em;
  }

  .shopify-policy__body li {
    margin-bottom: 0.5em;
  }
</style>
