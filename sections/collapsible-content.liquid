{%- comment -%}
  Collapsible Content / FAQ Section - Tailwind Version
  Modern accordion design with optional image
{%- endcomment -%}

<section class="py-12 lg:py-16">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    {%- comment -%} Header {%- endcomment -%}
    <div class="{% if section.settings.heading_alignment == 'center' %}text-center{% elsif section.settings.heading_alignment == 'right' %}text-right{% endif %} mb-8 lg:mb-12">
      {%- if section.settings.caption != blank -%}
        <p class="text-sm font-medium uppercase tracking-wider text-neutral-500 mb-2">
          {{ section.settings.caption | escape }}
        </p>
      {%- endif -%}
      {%- if section.settings.heading != blank -%}
        <h2 class="text-2xl lg:text-3xl font-semibold text-neutral-900">
          {{ section.settings.heading }}
        </h2>
      {%- endif -%}
    </div>

    {%- comment -%} Content Grid {%- endcomment -%}
    <div class="grid grid-cols-1 {% if section.settings.image != blank %}lg:grid-cols-2{% endif %} gap-8 lg:gap-12 {% if section.settings.desktop_layout == 'image_second' %}lg:flex-row-reverse{% endif %}">
      {%- comment -%} Image {%- endcomment -%}
      {%- if section.settings.image != blank -%}
        <div class="{% if section.settings.desktop_layout == 'image_second' %}lg:order-2{% endif %}">
          <div class="relative rounded-xl overflow-hidden bg-neutral-100
            {% if section.settings.image_ratio == 'small' %}aspect-[4/3]
            {% elsif section.settings.image_ratio == 'large' %}aspect-[3/4]
            {% endif %}">
            {{
              section.settings.image
              | image_url: width: 1200
              | image_tag:
                class: 'w-full h-full object-cover',
                loading: 'lazy',
                widths: '400, 600, 800, 1000, 1200'
            }}
          </div>
        </div>
      {%- endif -%}

      {%- comment -%} Accordion Items {%- endcomment -%}
      <div class="{% if section.settings.desktop_layout == 'image_second' %}lg:order-1{% endif %}">
        <div class="divide-y divide-neutral-200 border-y border-neutral-200">
          {%- for block in section.blocks -%}
            <details
              class="group"
              {{ block.shopify_attributes }}
              {% if section.settings.open_first_collapsible_row and forloop.first %}open{% endif %}
            >
              <summary class="flex items-center justify-between gap-4 py-5 cursor-pointer list-none hover:bg-neutral-50 -mx-4 px-4 transition-colors">
                <div class="flex items-center gap-3">
                  {%- if block.settings.icon != 'none' -%}
                    <span class="flex-shrink-0 text-neutral-500">
                      {%- render 'icon-accordion', icon: block.settings.icon -%}
                    </span>
                  {%- endif -%}
                  <h3 class="text-base font-medium text-neutral-900 group-hover:underline underline-offset-4">
                    {{ block.settings.heading | default: block.settings.page.title | escape }}
                  </h3>
                </div>
                <span class="flex-shrink-0 text-neutral-400 transition-transform duration-300 group-open:rotate-180">
                  {%- render 'icon', name: 'caret-down', size: '20' -%}
                </span>
              </summary>
              <div class="pb-5 pr-8 text-neutral-600 prose prose-sm max-w-none">
                {{ block.settings.row_content }}
                {{ block.settings.page.content }}
              </div>
            </details>
          {%- endfor -%}
        </div>
      </div>
    </div>
  </div>
</section>

{% schema %}
{
  "name": "t:sections.collapsible_content.name",
  "tag": "section",
  "class": "section",
  "disabled_on": {
    "groups": ["header", "footer"]
  },
  "settings": [
    {
      "type": "text",
      "id": "caption",
      "label": "t:sections.collapsible_content.settings.caption.label"
    },
    {
      "type": "inline_richtext",
      "id": "heading",
      "label": "t:sections.collapsible_content.settings.heading.label",
      "default": "t:sections.collapsible_content.settings.heading.default"
    },
    {
      "type": "select",
      "id": "heading_alignment",
      "label": "t:sections.collapsible_content.settings.heading_alignment.label",
      "options": [
        {
          "value": "left",
          "label": "t:sections.collapsible_content.settings.heading_alignment.options__1.label"
        },
        {
          "value": "center",
          "label": "t:sections.collapsible_content.settings.heading_alignment.options__2.label"
        },
        {
          "value": "right",
          "label": "t:sections.collapsible_content.settings.heading_alignment.options__3.label"
        }
      ],
      "default": "center"
    },
    {
      "type": "checkbox",
      "id": "open_first_collapsible_row",
      "default": false,
      "label": "t:sections.collapsible_content.settings.open_first_collapsible_row.label"
    },
    {
      "type": "header",
      "content": "t:sections.collapsible_content.settings.header.content"
    },
    {
      "type": "image_picker",
      "id": "image",
      "label": "t:sections.collapsible_content.settings.image.label"
    },
    {
      "type": "select",
      "id": "image_ratio",
      "options": [
        {
          "value": "adapt",
          "label": "t:sections.collapsible_content.settings.image_ratio.options__1.label"
        },
        {
          "value": "small",
          "label": "t:sections.collapsible_content.settings.image_ratio.options__2.label"
        },
        {
          "value": "large",
          "label": "t:sections.collapsible_content.settings.image_ratio.options__3.label"
        }
      ],
      "default": "adapt",
      "label": "t:sections.collapsible_content.settings.image_ratio.label"
    },
    {
      "type": "select",
      "id": "desktop_layout",
      "options": [
        {
          "value": "image_first",
          "label": "t:sections.collapsible_content.settings.desktop_layout.options__1.label"
        },
        {
          "value": "image_second",
          "label": "t:sections.collapsible_content.settings.desktop_layout.options__2.label"
        }
      ],
      "default": "image_second",
      "label": "t:sections.collapsible_content.settings.desktop_layout.label"
    }
  ],
  "blocks": [
    {
      "type": "collapsible_row",
      "name": "t:sections.collapsible_content.blocks.collapsible_row.name",
      "settings": [
        {
          "type": "text",
          "id": "heading",
          "default": "t:sections.collapsible_content.blocks.collapsible_row.settings.heading.default",
          "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.heading.label"
        },
        {
          "type": "select",
          "id": "icon",
          "options": [
            {
              "value": "none",
              "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.options__1.label"
            },
            {
              "value": "check_mark",
              "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.options__8.label"
            },
            {
              "value": "heart",
              "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.options__16.label"
            },
            {
              "value": "leaf",
              "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.options__18.label"
            },
            {
              "value": "question_mark",
              "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.options__32.label"
            },
            {
              "value": "return",
              "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.options__34.label"
            },
            {
              "value": "ruler",
              "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.options__35.label"
            },
            {
              "value": "truck",
              "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.options__43.label"
            }
          ],
          "default": "none",
          "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.label"
        },
        {
          "type": "richtext",
          "id": "row_content",
          "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.row_content.label"
        },
        {
          "type": "page",
          "id": "page",
          "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.page.label"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "t:sections.collapsible_content.presets.name",
      "blocks": [
        {
          "type": "collapsible_row"
        },
        {
          "type": "collapsible_row"
        },
        {
          "type": "collapsible_row"
        },
        {
          "type": "collapsible_row"
        }
      ]
    }
  ]
}
{% endschema %}
