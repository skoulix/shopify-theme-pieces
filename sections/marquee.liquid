{%- comment -%}
  Marquee Section - Infinite scrolling text ticker
  Common on modern Awwwards-style sites
{%- endcomment -%}

<style>
  /* ==========================================================================
     Marquee Section - Custom CSS for animation, clamp(), and Liquid values
     ========================================================================== */

  /* Section padding - requires clamp() */
  .marquee-section {
    padding: clamp(1.5rem, 3vh, 3rem) 0;
  }

  /* Animation - requires Liquid dynamic speed and @keyframes */
  .marquee-content {
    gap: clamp(2rem, 5vw, 5rem);
    padding-right: clamp(2rem, 5vw, 5rem);
    animation: marquee {{ section.settings.speed }}s linear infinite;
  }

  .marquee-section[data-direction="right"] .marquee-content {
    animation-direction: reverse;
  }

  .marquee-section[data-pause-on-hover="true"]:hover .marquee-content {
    animation-play-state: paused;
  }

  @keyframes marquee {
    from { transform: translateX(0); }
    to { transform: translateX(-100%); }
  }

  /* Item gap - requires clamp() */
  .marquee-item {
    gap: clamp(2rem, 5vw, 5rem);
  }

  /* Text - requires clamp() */
  .marquee-text {
    font-size: clamp(1.5rem, 6vw, 3rem);
    line-height: 1;
    letter-spacing: calc(-0.03em + var(--heading-letter-spacing, 0em));
  }

  @media (min-width: 1024px) {
    .marquee-text {
      font-size: clamp(2rem, 4vw, 3.5rem);
    }
  }

  @media (min-width: 1536px) {
    .marquee-text {
      font-size: clamp(2.5rem, 3.5vw, 4.5rem);
    }
  }

  /* Outline text */
  .marquee-text.outline {
    color: transparent;
    -webkit-text-stroke: 1px var(--color-text);
  }

  /* Separator - requires clamp() */
  .marquee-separator {
    width: clamp(6px, 1vw, 12px);
    height: clamp(6px, 1vw, 12px);
    background-color: currentColor;
  }

  /* Icon - requires clamp() */
  .marquee-icon {
    font-size: clamp(1.25rem, 3vw, 2rem);
  }

  @media (min-width: 1536px) {
    .marquee-icon {
      font-size: clamp(1.5rem, 2.5vw, 2.5rem);
    }
  }
</style>

<section
  class="marquee-section overflow-hidden color-{{ section.settings.color_scheme }}"
  data-marquee-section="{{ section.id }}"
  data-direction="{{ section.settings.direction }}"
  data-pause-on-hover="{{ section.settings.pause_on_hover }}"
>
  <div class="marquee-wrapper flex w-max">
    {%- comment -%} Duplicate content for seamless loop {%- endcomment -%}
    {% for i in (1..4) %}
      <div class="marquee-content flex items-center">
        {% for block in section.blocks %}
          <div class="marquee-item flex items-center whitespace-nowrap" {{ block.shopify_attributes }}>
            {% case block.type %}
              {% when 'text' %}
                <span class="marquee-text font-bold uppercase leading-none {% if block.settings.outline %}outline{% endif %}">
                  {{ block.settings.text }}
                </span>
              {% when 'separator' %}
                {% if block.settings.style == 'dot' %}
                  <span class="marquee-separator rounded-full opacity-40 shrink-0"></span>
                {% elsif block.settings.style == 'icon' %}
                  <i class="marquee-icon ph ph-{{ block.settings.icon }} opacity-60"></i>
                {% endif %}
            {% endcase %}
          </div>
        {% endfor %}
      </div>
    {% endfor %}
  </div>
</section>

{% schema %}
{
  "name": "Marquee",
  "tag": "section",
  "class": "marquee-section-wrapper",
  "settings": [
    {
      "type": "range",
      "id": "speed",
      "min": 10,
      "max": 60,
      "step": 5,
      "default": 30,
      "unit": "s",
      "label": "Animation speed"
    },
    {
      "type": "select",
      "id": "direction",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "right", "label": "Right" }
      ],
      "default": "left",
      "label": "Direction"
    },
    {
      "type": "checkbox",
      "id": "pause_on_hover",
      "default": true,
      "label": "Pause on hover"
    },
    {
      "type": "header",
      "content": "Colors"
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color scheme",
      "default": "scheme-3"
    }
  ],
  "blocks": [
    {
      "type": "text",
      "name": "Text",
      "settings": [
        {
          "type": "text",
          "id": "text",
          "default": "Free Shipping",
          "label": "Text"
        },
        {
          "type": "checkbox",
          "id": "outline",
          "default": false,
          "label": "Outline style"
        }
      ]
    },
    {
      "type": "separator",
      "name": "Separator",
      "settings": [
        {
          "type": "select",
          "id": "style",
          "options": [
            { "value": "dot", "label": "Dot" },
            { "value": "icon", "label": "Icon" }
          ],
          "default": "dot",
          "label": "Style"
        },
        {
          "type": "text",
          "id": "icon",
          "default": "star-four",
          "label": "Icon name",
          "info": "Phosphor icon name (e.g., star-four, asterisk, diamond)"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Marquee",
      "category": "Scrolling & animation",
      "blocks": [
        { "type": "text", "settings": { "text": "Free Shipping" } },
        { "type": "separator", "settings": { "style": "dot" } },
        { "type": "text", "settings": { "text": "New Arrivals", "outline": true } },
        { "type": "separator", "settings": { "style": "icon", "icon": "star-four" } },
        { "type": "text", "settings": { "text": "Limited Edition" } },
        { "type": "separator", "settings": { "style": "dot" } }
      ]
    }
  ]
}
{% endschema %}
