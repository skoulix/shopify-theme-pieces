
{%- comment -%}
  Video Section - Displays a video with optional looping
{%- endcomment -%}

{%- liquid
  capture container_class
    render 'container-class', full_width: section.settings.full_width
  endcapture

  # Content alignment classes (includes flex items alignment for video overlay)
  case section.settings.header_alignment
    when 'left'
      assign content_align_class = 'items-start text-left'
    when 'right'
      assign content_align_class = 'items-end text-right'
    else
      assign content_align_class = 'items-center text-center'
  endcase
-%}

<div
  class="video-section section-padding{% unless section.settings.padding == 'default' %}-{{ section.settings.padding }}{% endunless %} color-{{ section.settings.color_scheme }}"
  data-video-section="{{ section.id }}"
  style="--video-aspect-ratio: {{ section.settings.aspect_ratio }}; --video-border-radius: {{ section.settings.border_radius }}px;"
>
  <div class="{{ container_class }}">
    <div class="video-container{% if section.settings.show_controls %} show-controls{% endif %}">
      {% if section.settings.video != blank %}
        {{ section.settings.video | video_tag:
          autoplay: true,
          muted: true,
          playsinline: true,
          preload: 'auto',
          loop: section.settings.loop,
          controls: section.settings.show_controls
        }}
      {% else %}
        <div class="video-placeholder">
          <div class="video-placeholder-pattern"></div>
          <div class="video-placeholder-grid"></div>
          <div class="video-placeholder-glow"></div>
          <div class="video-placeholder-content">
            <div class="video-placeholder-icon">
              <i class="ph ph-play"></i>
            </div>
            <div class="video-placeholder-text">
              <p class="text-label-sm" style="color: rgba(255, 255, 255, 0.5);">Select a video</p>
              <div class="video-placeholder-bars">
                <span></span>
                <span></span>
                <span></span>
                <span></span>
                <span></span>
              </div>
            </div>
          </div>
        </div>
      {% endif %}

      {% if section.settings.overlay_opacity > 0 %}
        <div class="video-overlay" style="background: {{ section.settings.overlay_color }}; opacity: {{ section.settings.overlay_opacity | divided_by: 100.0 }};"></div>
      {% endif %}

      {% if section.settings.title != blank or section.settings.text != blank or section.settings.button_text != blank %}
        <div class="video-content {{ content_align_class }}" style="justify-content: {{ section.settings.content_position }};" data-tween-group="video-content-{{ section.id }}">
          {% if section.settings.label != blank %}
            <span class="section-label" data-tween data-tween-type="fade-up">
              {{ section.settings.label }}
            </span>
          {% endif %}

          {% if section.settings.title != blank %}
            <h2 class="section-title" data-tween data-tween-type="split-text">
              {{ section.settings.title }}
            </h2>
          {% endif %}

          {% if section.settings.text != blank %}
            <p class="section-description" data-tween data-tween-type="fade-up">
              {{ section.settings.text }}
            </p>
          {% endif %}

          {% if section.settings.button_text != blank and section.settings.button_link != blank %}
            {% render 'button',
              text: section.settings.button_text,
              url: section.settings.button_link,
              style: section.settings.button_style,
              color: section.settings.button_color,
              size: section.settings.button_size,
              extra_class: 'mt-8',
              animate: true
            %}
          {% endif %}
        </div>
      {% endif %}
    </div>
  </div>
</div>

{%- comment -%} Animations handled by global TweenManager via data-tween attributes {%- endcomment -%}

{% schema %}
{
  "name": "t:sections.video.name",
  "tag": "section",
  "class": "video-section",
  "settings": [
    {
      "type": "header",
      "content": "t:shared.headers.video"
    },
    {
      "type": "video",
      "id": "video",
      "label": "t:shared.settings.video.label",
      "info": "t:shared.info.upload_video"
    },
    {
      "type": "checkbox",
      "id": "loop",
      "default": true,
      "label": "t:sections.video.settings.loop.label"
    },
    {
      "type": "checkbox",
      "id": "show_controls",
      "default": false,
      "label": "t:shared.settings.show_controls.label"
    },
    {
      "type": "select",
      "id": "aspect_ratio",
      "options": [
        {
          "value": "16/9",
          "label": "t:shared.settings.aspect_ratio.options__7.label"
        },
        {
          "value": "21/9",
          "label": "t:shared.settings.aspect_ratio.options__8.label"
        },
        {
          "value": "4/3",
          "label": "t:shared.settings.aspect_ratio.options__5.label"
        },
        {
          "value": "1/1",
          "label": "t:shared.settings.aspect_ratio.options__1.label"
        },
        {
          "value": "9/16",
          "label": "t:shared.settings.aspect_ratio.options__9.label"
        }
      ],
      "default": "16/9",
      "label": "t:shared.settings.aspect_ratio.label"
    },
    {
      "type": "range",
      "id": "border_radius",
      "min": 0,
      "max": 40,
      "step": 4,
      "default": 0,
      "unit": "px",
      "label": "t:shared.settings.border_radius.label"
    },
    {
      "type": "header",
      "content": "t:shared.headers.overlay"
    },
    {
      "type": "color",
      "id": "overlay_color",
      "default": "#000000",
      "label": "t:shared.settings.overlay_color.label"
    },
    {
      "type": "range",
      "id": "overlay_opacity",
      "min": 0,
      "max": 80,
      "step": 5,
      "default": 30,
      "unit": "%",
      "label": "t:shared.settings.overlay_opacity.label"
    },
    {
      "type": "header",
      "content": "t:shared.headers.content"
    },
    {
      "type": "text",
      "id": "label",
      "label": "t:shared.settings.label.label"
    },
    {
      "type": "text",
      "id": "title",
      "label": "t:shared.settings.title.label"
    },
    {
      "type": "textarea",
      "id": "text",
      "label": "t:shared.settings.text.label"
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "t:shared.settings.button_text.label"
    },
    {
      "type": "url",
      "id": "button_link",
      "label": "t:shared.settings.button_link.label"
    },
    {
      "type": "select",
      "id": "button_style",
      "label": "t:shared.settings.button_style.label",
      "default": "outline",
      "options": [
        {
          "value": "solid",
          "label": "t:shared.settings.button_style.options__0.label"
        },
        {
          "value": "outline",
          "label": "t:shared.settings.button_style.options__1.label"
        }
      ]
    },
    {
      "type": "select",
      "id": "button_color",
      "label": "t:shared.settings.button_color.label",
      "default": "primary",
      "options": [
        {
          "value": "primary",
          "label": "t:shared.settings.button_color.options__0.label"
        },
        {
          "value": "secondary",
          "label": "t:shared.settings.button_color.options__1.label"
        }
      ]
    },
    {
      "type": "select",
      "id": "button_size",
      "label": "t:shared.settings.button_size.label",
      "default": "large",
      "options": [
        {
          "value": "small",
          "label": "t:shared.settings.button_size.options__0.label"
        },
        {
          "value": "default",
          "label": "t:shared.settings.button_size.options__1.label"
        },
        {
          "value": "large",
          "label": "t:shared.settings.button_size.options__2.label"
        }
      ]
    },
    {
      "type": "select",
      "id": "content_position",
      "options": [
        {
          "value": "flex-start",
          "label": "t:shared.options.top"
        },
        {
          "value": "center",
          "label": "t:shared.options.center"
        },
        {
          "value": "flex-end",
          "label": "t:shared.options.bottom"
        }
      ],
      "default": "center",
      "label": "t:sections.video.settings.content_position.label"
    },
    {
      "type": "header",
      "content": "t:shared.headers.layout"
    },
    {
      "type": "checkbox",
      "id": "full_width",
      "default": true,
      "label": "t:shared.settings.full_width.label"
    },
    {
      "type": "text_alignment",
      "id": "header_alignment",
      "label": "t:shared.settings.header_alignment.label",
      "default": "center"
    },
    {
      "type": "select",
      "id": "padding",
      "label": "t:shared.settings.padding.label",
      "info": "t:shared.settings.padding.info",
      "default": "default",
      "options": [
        {
          "value": "default",
          "label": "t:shared.settings.padding.options__2.label"
        },
        {
          "value": "small",
          "label": "t:shared.settings.padding.options__1.label"
        },
        {
          "value": "large",
          "label": "t:shared.settings.padding.options__3.label"
        },
        {
          "value": "none",
          "label": "t:shared.settings.padding.options__0.label"
        }
      ]
    },
    {
      "type": "header",
      "content": "t:shared.headers.colors"
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "t:shared.settings.color_scheme.label",
      "default": "scheme-1"
    }
  ],
  "presets": [
    {
      "name": "t:sections.video.presets.video.name",
      "category": "t:shared.categories.image_media"
    }
  ],
  "disabled_on": {
    "groups": [
      "header",
      "footer"
    ]
  }
}
{% endschema %}
