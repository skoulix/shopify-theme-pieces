{%- comment -%}
  Features Grid Section - Creative bento-style grid for features
{%- endcomment -%}

{%- liquid
  capture container_class
    render 'container-class', full_width: section.settings.full_width, full_class: 'container-fluid'
  endcapture

  capture header_container_class
    render 'container-class', full_width: section.settings.full_width, full_class: 'container-fluid'
  endcapture
-%}

<section
  class="features-grid-section-wrapper section-padding color-{{ section.settings.color_scheme }}"
  data-features-grid-section="{{ section.id }}"
  style="--features-columns: {{ section.settings.columns }}"
>
  {%- comment -%} Header - always contained {%- endcomment -%}
  {% if section.settings.label != blank or section.settings.title != blank %}
    <div class="{{ header_container_class }}">
      <div class="features-grid-header">
        {% render 'section-header',
          label: section.settings.label,
          title: section.settings.title,
          description: section.settings.description,
          alignment: section.settings.header_alignment,
          group_id: 'features-grid-header-' | append: section.id
        %}
      </div>
    </div>
  {% endif %}

  {%- comment -%} Features Grid {%- endcomment -%}
  <div class="{{ container_class }}">
    <div class="features-grid-container {{ section.settings.layout }}-layout lg:grid-cols-[repeat(var(--features-columns),1fr)]" data-tween data-tween-type="fade-up">
      {% for block in section.blocks %}
        <div
          class="feature-item{% if section.settings.layout == 'bento' and forloop.first %} is-large{% endif %}"
          {{ block.shopify_attributes }}
        >
          <span class="feature-item-number text-label-sm">
            {{ forloop.index | prepend: '00' | slice: -2, 2 }}
          </span>

          {%- if block.settings.custom_icon != blank -%}
            <div class="feature-item-icon feature-item-icon--custom">
              {{ block.settings.custom_icon | image_url: width: 80 | image_tag:
                loading: 'lazy',
                decoding: 'async',
                alt: block.settings.title
              }}
            </div>
          {%- elsif block.settings.icon != 'none' -%}
            <div class="feature-item-icon">
              <i class="ph ph-{{ block.settings.icon }}"></i>
            </div>
          {%- endif -%}

          {% if block.settings.title != blank %}
            <h3 class="feature-item-title font-heading">
              {{ block.settings.title }}
            </h3>
          {% endif %}

          {% if block.settings.text != blank %}
            <p class="feature-item-text">
              {{ block.settings.text }}
            </p>
          {% endif %}

          {% if block.settings.link != blank and block.settings.link_text != blank %}
            <a href="{{ block.settings.link }}" class="feature-item-link text-link-sm">
              <span class="feature-item-link-text-wrapper">
                <span class="feature-item-link-text" data-hover="{{ block.settings.link_text }}">{{ block.settings.link_text }}</span>
              </span>
              <i class="ph ph-arrow-right"></i>
            </a>
          {% endif %}
        </div>
      {% endfor %}
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Features Grid",
  "tag": "section",
  "class": "features-grid-section",
  "settings": [
    {
      "type": "header",
      "content": "Header"
    },
    {
      "type": "text",
      "id": "label",
      "default": "Why Choose Us",
      "label": "Label"
    },
    {
      "type": "text",
      "id": "title",
      "default": "Features That Set Us Apart",
      "label": "Title"
    },
    {
      "type": "textarea",
      "id": "description",
      "default": "Everything you need to create an amazing shopping experience.",
      "label": "Description"
    },
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "checkbox",
      "id": "full_width",
      "default": false,
      "label": "Full width"
    },
    {
      "type": "select",
      "id": "header_alignment",
      "label": "Header alignment",
      "default": "left",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "center", "label": "Center" },
        { "value": "right", "label": "Right" }
      ]
    },
    {
      "type": "header",
      "content": "Grid Layout"
    },
    {
      "type": "select",
      "id": "layout",
      "options": [
        { "value": "standard", "label": "Standard Grid" },
        { "value": "bento", "label": "Bento (Featured First)" }
      ],
      "default": "standard",
      "label": "Layout style"
    },
    {
      "type": "range",
      "id": "columns",
      "min": 2,
      "max": 4,
      "step": 1,
      "default": 3,
      "label": "Columns (standard layout)"
    },
    {
      "type": "header",
      "content": "Colors"
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color scheme",
      "default": "scheme-1"
    }
  ],
  "blocks": [
    {
      "type": "feature",
      "name": "Feature",
      "settings": [
        {
          "type": "select",
          "id": "icon",
          "label": "Icon",
          "default": "star",
          "options": [
            { "value": "none", "label": "None" },
            { "value": "star", "label": "Star (Quality)" },
            { "value": "shield-check", "label": "Shield check (Security)" },
            { "value": "lock-simple", "label": "Lock (Secure)" },
            { "value": "truck", "label": "Truck (Shipping)" },
            { "value": "package", "label": "Package (Delivery)" },
            { "value": "arrow-counter-clockwise", "label": "Return arrow (Returns)" },
            { "value": "credit-card", "label": "Credit card (Payment)" },
            { "value": "headset", "label": "Headset (Support)" },
            { "value": "chat-circle", "label": "Chat (Support)" },
            { "value": "medal", "label": "Medal (Award)" },
            { "value": "certificate", "label": "Certificate (Certified)" },
            { "value": "heart", "label": "Heart (Love)" },
            { "value": "leaf", "label": "Leaf (Eco)" },
            { "value": "recycle", "label": "Recycle (Sustainable)" },
            { "value": "hand-heart", "label": "Hand heart (Care)" },
            { "value": "clock", "label": "Clock (Fast)" },
            { "value": "gift", "label": "Gift (Free gift)" },
            { "value": "percent", "label": "Percent (Discount)" },
            { "value": "globe", "label": "Globe (Worldwide)" },
            { "value": "lightning", "label": "Lightning (Fast)" },
            { "value": "sparkle", "label": "Sparkle (Premium)" },
            { "value": "users", "label": "Users (Community)" },
            { "value": "chart-line-up", "label": "Chart (Growth)" },
            { "value": "target", "label": "Target (Goal)" },
            { "value": "rocket", "label": "Rocket (Launch)" },
            { "value": "code", "label": "Code (Tech)" },
            { "value": "paint-brush", "label": "Paint brush (Design)" },
            { "value": "wrench", "label": "Wrench (Tools)" },
            { "value": "gear", "label": "Gear (Settings)" }
          ]
        },
        {
          "type": "image_picker",
          "id": "custom_icon",
          "label": "Custom icon",
          "info": "Overrides the icon selection above"
        },
        {
          "type": "text",
          "id": "title",
          "default": "Feature Title",
          "label": "Title"
        },
        {
          "type": "textarea",
          "id": "text",
          "default": "Describe this feature and how it benefits your customers.",
          "label": "Description"
        },
        {
          "type": "text",
          "id": "link_text",
          "default": "Learn More",
          "label": "Link text"
        },
        {
          "type": "url",
          "id": "link",
          "label": "Link"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Features Grid",
      "category": "Text & content",
      "blocks": [
        { "type": "feature", "settings": { "icon": "truck", "title": "Free Shipping", "text": "Enjoy free shipping on all orders over $50. Fast and reliable delivery to your doorstep." } },
        { "type": "feature", "settings": { "icon": "shield-check", "title": "Secure Payment", "text": "Your payment information is protected with industry-leading encryption." } },
        { "type": "feature", "settings": { "icon": "arrow-counter-clockwise", "title": "Easy Returns", "text": "Not satisfied? Return within 30 days for a full refund, no questions asked." } }
      ]
    }
  ],
  "disabled_on": {
    "groups": ["header", "footer"]
  }
  }
{% endschema %}
