{%- comment -%}
  Multicolumn Section
  Flexible grid of columns with icons, images, or text
  Great for USPs, features, services, policies
{%- endcomment -%}

{%- liquid
  assign columns_desktop = section.settings.columns_desktop
  assign columns_mobile = section.settings.columns_mobile
  assign alignment = section.settings.alignment
  assign icon_size = section.settings.icon_size
  assign image_ratio = section.settings.image_ratio
  assign section_bg = section.settings.background_color
  assign text_color = section.settings.text_color
-%}

<style>
  #multicolumn-{{ section.id }} {
    --section-bg: {{ section_bg }};
    --text-color: {{ text_color }};
    --icon-size: {{ icon_size }}px;
  }

  #multicolumn-{{ section.id }} .multicolumn-wrapper {
    background-color: var(--section-bg);
    color: var(--text-color);
  }

  #multicolumn-{{ section.id }} .multicolumn-grid {
    display: grid;
    gap: 2rem;
    grid-template-columns: repeat({{ columns_mobile }}, 1fr);
  }

  @media (min-width: 640px) {
    #multicolumn-{{ section.id }} .multicolumn-grid {
      grid-template-columns: repeat(2, 1fr);
    }
  }

  @media (min-width: 1024px) {
    #multicolumn-{{ section.id }} .multicolumn-grid {
      grid-template-columns: repeat({{ columns_desktop }}, 1fr);
    }
  }

  #multicolumn-{{ section.id }} .multicolumn-icon {
    width: var(--icon-size);
    height: var(--icon-size);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: calc(var(--icon-size) * 0.5);
  }

  #multicolumn-{{ section.id }} .multicolumn-image {
    aspect-ratio: {{ image_ratio }};
    object-fit: cover;
    width: 100%;
    border-radius: {{ settings.card_radius }}px;
  }

  #multicolumn-{{ section.id }} .multicolumn-item a {
    color: var(--text-color);
  }

  #multicolumn-{{ section.id }} .multicolumn-item a:hover {
    opacity: 0.8;
  }
</style>

<section id="multicolumn-{{ section.id }}" class="multicolumn-section">
  <div class="multicolumn-wrapper py-12 lg:py-20">
    <div class="page-container">
      {%- comment -%} Section Header {%- endcomment -%}
      {% if section.settings.heading != blank or section.settings.subheading != blank %}
        <div class="mb-12 {% if alignment == 'center' %}text-center{% elsif alignment == 'right' %}text-right{% endif %}">
          {% if section.settings.subheading != blank %}
            <p class="text-sm uppercase tracking-wider mb-3 opacity-70" data-intro>
              {{ section.settings.subheading }}
            </p>
          {% endif %}
          {% if section.settings.heading != blank %}
            <h2 class="text-3xl lg:text-4xl font-semibold font-heading" data-intro>
              {{ section.settings.heading }}
            </h2>
          {% endif %}
        </div>
      {% endif %}

      {%- comment -%} Columns Grid {%- endcomment -%}
      <div class="multicolumn-grid">
        {% for block in section.blocks %}
          <div
            class="multicolumn-item text-{{ alignment }}"
            data-intro
            {{ block.shopify_attributes }}
          >
            {%- comment -%} Icon or Image {%- endcomment -%}
            {% if block.settings.image != blank %}
              <div class="mb-4 {% if alignment == 'center' %}mx-auto{% elsif alignment == 'right' %}ml-auto{% endif %}" style="max-width: {{ icon_size | times: 2 }}px;">
                <img
                  src="{{ block.settings.image | image_url: width: 400 }}"
                  alt="{{ block.settings.image.alt | escape }}"
                  width="{{ block.settings.image.width }}"
                  height="{{ block.settings.image.height }}"
                  class="multicolumn-image"
                  loading="lazy"
                >
              </div>
            {% elsif block.settings.icon != 'none' %}
              <div class="multicolumn-icon mb-4 rounded-full {% if alignment == 'center' %}mx-auto{% elsif alignment == 'right' %}ml-auto{% endif %}" style="background-color: color-mix(in srgb, var(--text-color) 10%, transparent);">
                <i class="ph ph-{{ block.settings.icon }}"></i>
              </div>
            {% endif %}

            {%- comment -%} Title {%- endcomment -%}
            {% if block.settings.title != blank %}
              <h3 class="text-lg font-semibold mb-2 font-heading">
                {% if block.settings.link != blank %}
                  <a href="{{ block.settings.link }}" class="hover:underline">
                    {{ block.settings.title }}
                  </a>
                {% else %}
                  {{ block.settings.title }}
                {% endif %}
              </h3>
            {% endif %}

            {%- comment -%} Text {%- endcomment -%}
            {% if block.settings.text != blank %}
              <p class="text-sm opacity-70 leading-relaxed">
                {{ block.settings.text }}
              </p>
            {% endif %}

            {%- comment -%} Button {%- endcomment -%}
            {% if block.settings.button_label != blank %}
              <a href="{{ block.settings.link }}" class="inline-flex items-center gap-1 mt-4 text-sm font-medium hover:underline">
                {{ block.settings.button_label }}
                <i class="ph ph-arrow-right"></i>
              </a>
            {% endif %}
          </div>
        {% endfor %}
      </div>
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Multicolumn",
  "tag": "section",
  "class": "multicolumn-section-wrapper",
  "settings": [
    {
      "type": "text",
      "id": "subheading",
      "label": "Subheading"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Why Choose Us"
    },
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "range",
      "id": "columns_desktop",
      "min": 2,
      "max": 6,
      "step": 1,
      "default": 4,
      "label": "Columns on desktop"
    },
    {
      "type": "range",
      "id": "columns_mobile",
      "min": 1,
      "max": 2,
      "step": 1,
      "default": 2,
      "label": "Columns on mobile"
    },
    {
      "type": "select",
      "id": "alignment",
      "label": "Content alignment",
      "default": "center",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "center", "label": "Center" },
        { "value": "right", "label": "Right" }
      ]
    },
    {
      "type": "header",
      "content": "Icon/Image"
    },
    {
      "type": "range",
      "id": "icon_size",
      "min": 40,
      "max": 100,
      "step": 10,
      "default": 60,
      "unit": "px",
      "label": "Icon/image size"
    },
    {
      "type": "select",
      "id": "image_ratio",
      "label": "Image ratio",
      "default": "1/1",
      "options": [
        { "value": "1/1", "label": "Square" },
        { "value": "4/3", "label": "Landscape" },
        { "value": "3/4", "label": "Portrait" },
        { "value": "16/9", "label": "Wide" }
      ]
    },
    {
      "type": "header",
      "content": "Colors"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text color",
      "default": "#111827"
    }
  ],
  "blocks": [
    {
      "type": "column",
      "name": "Column",
      "settings": [
        {
          "type": "select",
          "id": "icon",
          "label": "Icon",
          "default": "star",
          "options": [
            { "value": "none", "label": "None" },
            { "value": "truck", "label": "Truck (Shipping)" },
            { "value": "shield-check", "label": "Shield (Security)" },
            { "value": "arrows-counter-clockwise", "label": "Arrows (Returns)" },
            { "value": "headset", "label": "Headset (Support)" },
            { "value": "star", "label": "Star (Quality)" },
            { "value": "heart", "label": "Heart (Love)" },
            { "value": "gift", "label": "Gift" },
            { "value": "leaf", "label": "Leaf (Eco)" },
            { "value": "lock-simple", "label": "Lock (Secure)" },
            { "value": "lightning", "label": "Lightning (Fast)" },
            { "value": "check-circle", "label": "Check Circle" },
            { "value": "tag", "label": "Tag (Price)" },
            { "value": "package", "label": "Package" },
            { "value": "wallet", "label": "Wallet (Payment)" },
            { "value": "clock", "label": "Clock (Time)" },
            { "value": "sparkle", "label": "Sparkle" },
            { "value": "storefront", "label": "Store" }
          ]
        },
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image",
          "info": "Overrides icon if set"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Title",
          "default": "Feature title"
        },
        {
          "type": "textarea",
          "id": "text",
          "label": "Description",
          "default": "Brief description of this feature or benefit"
        },
        {
          "type": "text",
          "id": "button_label",
          "label": "Button label"
        },
        {
          "type": "url",
          "id": "link",
          "label": "Link"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Multicolumn",
      "blocks": [
        {
          "type": "column",
          "settings": {
            "icon": "truck",
            "title": "Free Shipping",
            "text": "Free shipping on all orders over $50"
          }
        },
        {
          "type": "column",
          "settings": {
            "icon": "arrows-counter-clockwise",
            "title": "Easy Returns",
            "text": "30-day return policy for your peace of mind"
          }
        },
        {
          "type": "column",
          "settings": {
            "icon": "shield-check",
            "title": "Secure Payment",
            "text": "Your payment information is safe with us"
          }
        },
        {
          "type": "column",
          "settings": {
            "icon": "headset",
            "title": "24/7 Support",
            "text": "Our team is here to help anytime"
          }
        }
      ]
    }
  ]
}
{% endschema %}
